(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[364],{1311:function(e,t,r){Promise.resolve().then(r.bind(r,1996))},1996:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var n=r(7437),i=r(2265),l=r(8582),s=r(1789),a=r(6463),o=r(6648),u=r(5345),c=r(2462),d=r(8002),m=r(1647),h=r(232),w=r(2601),f=r(9891),v=e=>{let{isSurvey:t=!1}=e,[r,s]=(0,i.useState)(!1),[v,g]=(0,i.useState)(!1),[p,x]=(0,i.useState)(null),[b,y]=(0,i.useState)({}),{windowSize:k,deviceType:T}=(0,d.Z)(),{startVidRecording:j,stopVidRecording:E}=(0,m.Z)(),{state:F,dispatch:S}=(0,c.y)(),R=parseInt((0,a.useSearchParams)().get("attempt")||"0"),N=R<3?"".concat(l.ho.surveyRoute,"?attempt=").concat(R+1):null;(0,i.useEffect)(()=>{t&&C()},[t]),(0,i.useEffect)(()=>{(null==p?void 0:p.isTimeOver)&&!v&&(z(p),g(!0))},[v,p]);let C=()=>{D(),j()},Z=(0,i.useRef)(),D=()=>{let{endTimePromise:e,stopTimer:t}=(0,u.H)(18e4);return Z.current=t,e.then(x),()=>{Z.current&&Z.current()}},q=(0,i.useCallback)(()=>{if(Z.current)return Z.current()},[]),z=(0,i.useCallback)(async function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&(await E(),s(!0),y(t=>{let n={...t,timeLimit:(null==e?void 0:e.timeLimit)||"",timeTaken:(null==e?void 0:e.timeTaken)||"",endTime:(null==e?void 0:e.endTime)||"",startTime:(null==e?void 0:e.startTime)||"",closedWithTimeout:(null==e?void 0:e.isTimeOver)||!1,screenHeight:k.height,screenWidth:k.width,deviceType:T,closedMidWay:r};return S({type:"UPDATE_SURVEY_DATA",attempt:R,task:l.ho.id,data:n}),n}))},[t,p,R,k,T]);return(0,n.jsxs)("div",{className:"relative w-screen h-screen overflow-hidden",children:[t&&(0,n.jsx)(h.Z,{handlePressAction:()=>{z(q(),!0)}}),(0,n.jsx)("div",{className:"relative h-screen w-full",children:(0,n.jsx)(o.default,{src:"/hallucination.gif",layout:"fill",objectFit:"contain",alt:"ocean",className:"h-screen w-auto"})}),(0,n.jsx)("div",{className:"absolute bottom-5 left-5",children:(0,n.jsx)("button",{className:"border border-black shadow-lg rounded-full bg-primary w-16 h-16 px-2 py-1 animate-recPulse ",onClick:()=>{t?z(q()):alert("you may start the game!")}})}),t&&(0,n.jsx)(f.C,{show:r,children:(0,n.jsx)(w.Z,{showFilter:r,reAttemptUrl:N,attempt:R,taskID:l.ho.id})})]})},g=r(8214),p=r(872);let x=()=>{let[e,t]=(0,i.useState)(!1);l.Ik.WheelTask;let r=()=>{t(!e)};return(0,n.jsx)(n.Fragment,{children:e?(0,n.jsx)(p.Z,{isFullScreen:e,children:(0,n.jsx)(v,{isSurvey:e})}):(0,n.jsxs)("div",{className:"w-full h-full overflow-hidden",children:[(0,n.jsx)(s.Z,{taskName:l.ho.title,taskMessage:l.ho.taskMessage,handleStartGame:()=>r()}),(0,n.jsx)(v,{})]})})};function b(){return(0,n.jsx)(g.Z,{children:(0,n.jsx)(x,{})})}},232:function(e,t,r){"use strict";var n=r(7437),i=r(2265);t.Z=e=>{let{handlePressAction:t}=e,[r,l]=(0,i.useState)(null),s=e=>{r&&r!==e?(console.log("close action will handle"),t(),l(null)):(l(e),setTimeout(()=>{l(null)},5e3))};return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"z-50 fixed right-0 top-0 p-3 cursor-pointer w-16 h-16 ",onClick:()=>s("top")}),(0,n.jsx)("div",{className:"z-50 fixed right-0 bottom-0 p-3 cursor-pointer w-16 h-16",onClick:()=>s("bottom")})]})}},872:function(e,t,r){"use strict";var n=r(7437),i=r(2265);t.Z=e=>{let{isFullScreen:t,children:r}=e,l=(0,i.useRef)(null);(0,i.useEffect)(()=>{t?s():a()},[t]);let s=async()=>{try{if(l.current){let e=l.current;e.requestFullscreen?await e.requestFullscreen():e.mozRequestFullScreen?await e.mozRequestFullScreen():e.webkitRequestFullscreen?await e.webkitRequestFullscreen():e.msRequestFullscreen&&await e.msRequestFullscreen()}}catch(e){console.error("Error trying to enter fullscreen mode:",e)}},a=async()=>{try{document.fullscreenElement&&(document.exitFullscreen?await document.exitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen())}catch(e){console.error("Error trying to exit fullscreen mode:",e)}};return(0,n.jsx)("div",{ref:l,style:{height:"100vh",width:"100vw",backgroundColor:"#f0f0f0"},children:r})}},1647:function(e,t,r){"use strict";var n=r(7257),i=r(3972),l=r(1064),s=r(2265);t.Z=()=>{let e=(0,s.useRef)(null),t=(0,s.useRef)([]),[r,a]=(0,s.useState)(!1),[o,u]=(0,s.useState)(null);return{isRecording:r,startVidRecording:async()=>{try{let r=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});u(r),e.current=new MediaRecorder(r,{mimeType:"video/webm"}),e.current.ondataavailable=e=>{e.data.size>0&&t.current.push(e.data)},e.current.start(),a(!0)}catch(e){console.error("Error accessing media devices.",e),alert("Camera access is required for this task"),window.location.reload()}},stopVidRecording:()=>new Promise(r=>{e.current?(e.current.stop(),e.current.onstop=async()=>{let e=new Blob(t.current,{type:"video/webm"});try{let s=new File([e],"video.webm",{type:"video/webm"}),c=await (0,i.l)(s);await (0,l.TP)(n.Y.temporaryDB,n.Y.tempVideo,c),t.current=[],a(!1),o&&(o.getTracks().forEach(e=>e.stop()),u(null)),r(c)}catch(e){console.error("Error converting video to base64:",e),r(null)}}):r(null)})}}},8002:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(2265);function i(){let[e,t]=(0,n.useState)({width:void 0,height:void 0}),[r,i]=(0,n.useState)(void 0);(0,n.useEffect)(()=>{let e=()=>{t({width:window.innerWidth,height:window.innerHeight})};return"undefined"!=typeof navigator&&i(navigator.userAgent),window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]);let l="number"==typeof(null==e?void 0:e.width)&&(null==e?void 0:e.width)<768,s="number"==typeof(null==e?void 0:e.width)&&(null==e?void 0:e.width)>=768;return{windowSize:e,isMobile:l,isDesktop:s,deviceType:r}}},5345:function(e,t,r){"use strict";r.d(t,{H:function(){return i}});let n=e=>new Date(new Date(e).getTime()).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",hour12:!0}),i=e=>{let t;let r=Date.now(),i=n(r);return{endTimePromise:new Promise(r=>{t=setTimeout(()=>{r(Date.now())},e)}).then(t=>{let l=t-r;return{startTime:i,endTime:n(t),timeLimit:e,isTimeOver:l>=e,timeTaken:l}}),stopTimer:()=>{clearTimeout(t);let l=Date.now(),s=l-r;return{startTime:i,endTime:n(l),timeLimit:e,isTimeOver:s>=e,timeTaken:s}}}}}},function(e){e.O(0,[7,648,398,642,601,971,275,744],function(){return e(e.s=1311)}),_N_E=e.O()}]);